title = "Gitleaks Configuration for Personal Website"

[extend]
useDefault = true

[allowlist]
description = "Allowlist for false positives and test data"

paths = [
  '''\.env\.example$''',
  '''\.env\.local\.example$''',
  '''\.secrets\.example$''',
  '''node_modules/''',
  '''\.next/''',
  '''\.vercel/''',
  '''pnpm-lock\.yaml$''',
  '''public/''',
  '''\.test\.(js|ts|tsx)$''',
  '''\.spec\.(js|ts|tsx)$''',
  '''^__tests__/''',
  '''^tests?/fixtures/''',
  '''^docs?/'''
]

regexes = [
  '''(?i)(test|demo|example|fake|mock)[-_]?(key|token|secret|api)''',
  '''EXAMPLE_''',
  '''YOUR_.*_HERE''',
  '''sk_test_''',
  '''pk_test_''',
  '''127\.0\.0\.1''',
  '''localhost''',
  '''x{10,}''',
  '''X{10,}'''
]

[[rules]]
id = "vercel-token"
description = "Vercel API Token"
regex = '''(?i)vercel[_-]?(token|api)["\']?\s*[:=]\s*["\']?([a-z0-9]{24,})'''
tags = ["vercel", "token"]

[[rules]]
id = "nextauth-secret"
description = "NextAuth Secret"
regex = '''NEXTAUTH_SECRET\s*=\s*["\']?[a-z0-9+/=]{32,}["\']?'''
tags = ["nextauth", "secret"]
entropy = 4.0
